<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>U3. Práctica 2-2</title>
    <script type="text/javascript">
    var crono = new Object();
    var ventana;
    var s;
    var m;
    var h;
    var nuevo;

    crono.empezar=function() {
      if (ventana==undefined) {
        ventana = window.open("", "", "width=300, height=200");
        ventana.document.body.innerHTML = "00:00:00";
      }
      crono.d = new Date().getTime();
      crono.contar();
    }

    crono.contar=function() {
      var t = new Date().getTime();

      var r = new Date(t-crono.d);
      if (nuevo==undefined) {
        var s = r.getUTCSeconds();
        var m = r.getUTCMinutes();
        var h = r.getUTCHours();
      } else {
        var s = r.getUTCSeconds() + parseInt(nuevo[2]);
        var m = r.getUTCMinutes() + parseInt(nuevo[1]);
        var h = r.getUTCHours() + parseInt(nuevo[0]);
      }

      ventana.document.body.innerHTML = crono.formatear(h) + ":" + crono.formatear(m) + ":" + crono.formatear(s);
      crono.timer = setTimeout(crono.contar, 1000);
    }

    crono.reiniciar=function() {
      clearTimeout(crono.timer);
      s = "00";
      m = "00";
      h = "00";
      ventana.document.body.innerHTML = h + ":" + m + ":" + s;
    }

    crono.formatear=function(i) {
      if (i<10) {
        i = "0" + i;
      }
      return i;
    }

    crono.parar=function() {
      clearTimeout(crono.timer);
      nuevo = ventana.document.body.innerHTML;
      nuevo = nuevo.split(":");
    }


    </script>
  </head>
  <body>
    <h1>Cronómetro</h1>
    <form name="formulario">
      <input type="button" name="boton" value="Reiniciar" onclick="crono.reiniciar()"></input>
      <input type="button" name="boton" value="Contar" onclick="crono.empezar()"></input>
      <input type="button" name="boton" value="Parar" onclick="crono.parar()"></input>
    </form>

  </body>
</html>
